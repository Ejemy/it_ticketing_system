/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2023 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

const bcrypt=require("bcrypt"),mysql=require("mysql"),{AddUserToDatabase,CheckIfEmailInDatabase,GetUserDatabase}=require("./databaseHandler"),{ValidateRegister}=require("./validator");async function TryRegisterUser(e,a){var{error:s,value:e}=ValidateRegister(e);if(s)return console.log(s),!1;const r=GetUserDatabase(mysql);if(r.connect(e=>e?console.log(e):void console.log("DB connection established...")),await CheckIfEmailInDatabase(r,e.email))return console.log(e.email+" is already in the database."),!0;s=await bcrypt.hash(e.password,12);return console.log("Adding user to database..."),await AddUserToDatabase(r,e.firstName,e.lastName,e.email,s),console.log(e.email+" has been added to the database."),!0}exports.TryRegisterUser=TryRegisterUser;