/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2023 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

const bcrypt=require("bcrypt"),{AddUserToDatabase,CheckIfEmailInDatabase,GetUserDatabase}=require("./databaseHandler"),{ValidateRegister}=require("./validator");async function TryRegisterUser(e,a){var{error:r,value:e}=ValidateRegister(e);if(r)return console.log(r),!1;const t=GetUserDatabase();if(t.connect(),await CheckIfEmailInDatabase(t,e.email))return console.log(e.email+" is already in the database."),!0;r=await bcrypt.hash(e.password,12);return await AddUserToDatabase(t,e.firstName,e.lastName,e.email,r),console.log(e.email+" has been added to the database."),!0}exports.TryRegisterUser=TryRegisterUser;